# 家庭资产管理系统 PRD

**版本**: 1.0  
**日期**: 2024-01-17  
**状态**: 初稿

---

## 1. 产品概述

### 1.1 产品定位
面向现代家庭的轻量级资产管理Web应用，提供资产统一归档、收支流水记录、多维度统计分析功能，支持家庭成员协作管理，帮助用户清晰掌握家庭财务状况。

### 1.2 核心价值
- **统一视图**：整合分散在各处的资产信息，一键生成家庭净值报表
- **简化记账**：3秒完成日常收支记录，自动归类
- **智能洞察**：可视化呈现资产结构变化，提供配置优化建议
- **家庭协作**：成员权限分级，数据实时同步

---

## 2. 目标用户

| 用户角色 | 特征 | 核心需求 |
|---------|------|---------|
| **家庭财务主理人** | 30-50岁，关注资产保值增值 | 资产总览、配置分析、财务报表 |
| **普通成员** | 需要查看或录入个人收支 | 快速记账、查看个人贡献 |
| **技术接受者** | 习惯Web/移动端操作 | 云端同步、数据导出、离线可用 |

---

## 3. 功能需求

### 模块一：资产档案管理

#### 3.1.1 资产分类体系
- **功能描述**：建立可扩展的资产分类树，支持自定义二级分类
- **分类模板**（预设）：
  ```
  固定资产
  ├─ 不动产（房产、车位）
  └─ 动产（车辆、贵重物品）
  
  流动资产
  ├─ 现金（钱包、备用金）
  └─ 存款（活期、定期、货币基金）
  
  投资资产
  ├─ 权益类（股票、基金）
  ├─ 债权类（债券、P2P）
  └─ 其他（数字货币、黄金）
  
  无形资产
  ├─ 保险（寿险、财险）
  └─ 债权债务（借款、应收款）
  ```
- **自定义能力**：用户可增删一级分类，调整二级分类
- **数据字段**：每个分类预设必填/选填字段（如房产：面积、地址、贷款情况）

#### 3.1.2 资产卡片管理
- **录入表单**：
  - 基础信息：名称、分类、持有人、购买日期
  - 价值信息：初始金额、当前估值、计价货币（支持多币种）
  - 扩展属性：动态显示分类特有字段（如股票：代码、持仓数量）
  - 凭证管理：支持上传图片/PDF（发票、合同），单文件≤5MB
- **估值方式**：
  - 手动更新：用户输入最新市值
  - 自动计算：根据买入价和涨跌幅推算（需对接公开API）
  - 折旧模板：对车辆、设备等按预设规则自动折旧
- **生命周期**：记录资产从"购入"→"持有"→"处置"全流程，支持查看历史变动明细

---

### 模块二：资金流水记账

#### 3.2.1 收支记录
- **快速记账入口**：
  - 悬浮按钮/Ctrl+N快捷键
  - 语音输入："餐饮支出50元"自动解析
  - OCR识别：上传小票自动提取金额、商户、日期
- **字段结构**：
  ```
  交易类型：收入 / 支出
  金额：数字输入，支持小数点后两位
  分类：从预设收支分类选择（餐饮、交通、工资等）
  账户：关联资产卡片（如招商银行储蓄卡）
  成员：选择交易归属人
  日期时间：默认当前，可修改
  备注：可选，支持#标签
  附件：支持图片上传
  ```
- **分类管理**：预设50+常见收支分类，用户可自定义，支持图标和颜色设置
- **批量操作**：支持导入银行账单（CSV/Excel格式），自动匹配分类

#### 3.2.2 资产变动追踪
- **变动类型**：
  - 买入：资金账户→投资资产（如买入股票）
  - 卖出：投资资产→资金账户
  - 转入/转出：不同账户间资金划转
  - 估值调整：手动更新资产市值
  - 折旧计提：自动计算固定资产折旧
- **关联机制**：每笔变动自动关联资金流水，保持账务一致性
- **历史追溯**：资产卡片页展示按时间倒序的所有变动记录

---

### 模块三：多维度统计报表

#### 3.3.1 资产概览仪表盘（首页）
- **核心指标卡片**：
  - 总资产净值（≈总资产-总负债）
  - 负债总额（房贷、车贷、信用卡欠款等）
  - 净资产 = 总资产 - 总负债
  - 流动比率 = 流动资产 / 月支出（建议值>3）
- **可视化组件**：
  - 饼图：资产分布（按一级分类）
  - 环形图：负债结构
  - 进度条：流动性比率健康度
- **筛选器**：按成员、时间范围、货币单位（支持自动汇率换算）过滤

#### 3.3.2 趋势分析
- **资产趋势图**：折线图展示所选时间范围内总资产/净资产变化
  - 支持月/季/年视图切换
  - 显示环比增长率
- **分类占比趋势**：堆叠面积图展示各类资产占比变化，识别配置漂移

#### 3.3.3 收支分析
- **支出结构**：桑基图或树状图展示资金流向
- **储蓄率计算**：(月收入-月支出)/月收入，提供平均值和趋势
- **预算对比**：
  - 支持为每个支出分类设置月度预算
  - 进度条显示已用比例，超支标红
  - 支持预算与实际对比柱状图

---

### 模块四：智能分析与预警

#### 3.4.1 资产配置健康度
- **诊断指标**（计算逻辑）：
  - **流动性比率** = 流动资产 / 月均支出
    - 健康：>6个月，警告：3-6个月，危险：<3个月
  - **投资性资产占比** = (投资资产+固定资产) / 总资产
    - 建议30-50岁家庭保持在60%-80%
  - **负债收入比** = 月还款额 / 月收入
    - 红线：>50%，预警：30-50%
- **建议输出**：根据指标异常提供可操作建议，如"流动性不足，建议增加货币基金配置"

---

### 模块五：家庭协作功能

#### 3.5.1 多用户权限管理
- **角色定义**：
  - **管理员**：邀请成员、设置权限、查看全部数据
  - **编辑者**：可增删改资产和流水，默认角色
  - **观察者**：仅查看，不可修改（适合长辈/未成年子女）
- **邀请机制**：通过邮箱/手机号发送邀请链接，新用户注册后自动加入家庭
- **数据隔离**：支持标记资产为"个人"或"共有"，成员可切换视图

#### 3.5.2 数据同步与导出
- **实时同步**：基于WebSocket的实时数据更新，一处修改多端同步
- **导出功能**：
  - 资产清单：PDF/Excel格式，含汇总页
  - 流水明细：按筛选条件导出，支持时间范围选择
  - 报表：仪表盘截图或完整数据包
- **备份策略**：
  - 自动备份：每日增量备份至云端存储
  - 手动备份：一键下载完整数据JSON
- **数据安全**：
  - 传输加密：HTTPS + WSS
  - 存储加密：敏感字段AES-256加密
  - 隐私保护：支持本地部署选项

---

### 模块六：轻量级特性

#### 3.6.1 极简录入
- **语音记账**：调用浏览器Web Speech API，支持"支出餐饮50元"指令
- **OCR识别**：集成Tesseract.js或调用云端API，识别发票关键字段
- **智能填充**：根据历史记录自动补充分类、账户

#### 3.6.2 技术体验优化
- **响应式设计**：移动端优先，断点：320px、768px、1024px
- **PWA支持**：
  - 离线模式：缓存最近30天数据，支持离线记账，联网后同步
  - 安装到主屏：提供原生应用体验
- **性能指标**：首屏加载<2s，交互响应<100ms
- **快捷键**：全局支持Ctrl+N记账、Ctrl+F搜索

---

## 4. 非功能需求

| 类别 | 要求 |
|------|------|
| **性能** | 支持1000+资产记录，10000+流水记录流畅查询 |
| **可用性** | 系统可用性>99%，计划维护窗口提前通知 |
| **兼容性** | Chrome 90+, Safari 14+, Firefox 88+, Edge 90+ |
| **可扩展性** | 支持插件机制，可扩展外部数据对接（如银行API） |
| **国际化** | 架构支持多语言，首期仅支持简体中文 |

---

## 5. 技术架构建议

### 5.1 技术栈选型
- **前端**: Vue 3 + TypeScript + Vite + Pinia
- **图表**: ECharts + Vue-ECharts
- **组件库**: Naive UI（轻量）或 Element Plus
- **后端**: Node.js + NestJS 或 Python + FastAPI
- **数据库**: PostgreSQL（主库）+ Redis（缓存）
- **部署**: Docker + Nginx，支持Railway/Vercel一键部署

### 5.2 数据模型核心实体
```sql
-- 资产表 assets
id, name, category_id, holder_id, initial_value, current_value, currency, purchase_date, status,凭证JSON

-- 流水表 transactions
id, type, amount, category, account_id, member_id, date, note, tags[], related_asset_id

-- 分类表 categories
id, name, parent_id, type(asset/income/expense), icon, color, is_builtin
```

---

## 6. 迭代计划（修订版）

> **规划原则**：每阶段都有可独立交付的价值，降低技术风险，预留缓冲时间

---

### **阶段一：MVP（6周）**
**目标**：单人使用、本地存储、核心功能闭环

| 周次 | 内容 | 交付物 |
|------|------|--------|
| W1-2 | 项目搭建 + 资产模块 | 项目框架、资产分类（固定模板）、资产卡片CRUD、本地存储（IndexedDB） |
| W3-4 | 记账模块 | 收支分类（固定30+）、收支记录CRUD、快速记账、基础表单验证 |
| W5-6 | 仪表盘 + 收尾 | 核心指标卡片、资产分布饼图、基础筛选、测试修复 |

**MVP 验收**：
- ✅ 能添加/编辑/删除资产
- ✅ 能记录收支流水
- ✅ 首页显示净资产和资产分布
- ✅ 数据持久化到本地
- ✅ 移动端可用（响应式基础版）

**技术栈简化**：
- 图表：Chart.js（替代 ECharts，体积更小）
- 存储：IndexedDB（无需后端）
- 组件库：Naive UI

---

### **阶段二：数据增强（4周）**
**目标**：资产变动追踪 + 报表能力提升

| 周次 | 内容 | 交付物 |
|------|------|--------|
| W7-8 | 资产变动追踪 | 买入/卖出/转入/转出/估值调整、资产历史记录页、流水与资产关联 |
| W9-10 | 报表增强 | 资产趋势折线图、支出结构分析、预算管理（基础版）、CSV/Excel导出 |

**验收**：
- ✅ 资产变动自动关联流水
- ✅ 可查看资产历史变动记录
- ✅ 可导出流水和资产清单

---

### **阶段三：云端化（4周）**
**目标**：后端服务 + 多设备同步

| 周次 | 内容 | 交付物 |
|------|------|--------|
| W11-12 | 后端开发 | NestJS/FastAPI 框架、RESTful API、JWT认证、PostgreSQL schema |
| W13-14 | 云端同步 | 用户注册登录、数据上传/下载、多设备数据合并、配置备份 |

**注意**：采用"定期同步"而非"实时同步"，降低复杂度

---

### **阶段四：家庭协作（4周）**
**目标**：多用户 + 权限管理

| 周次 | 内容 | 交付物 |
|------|------|--------|
| W15-16 | 家庭体系 | 家庭创建/加入、成员管理、管理员/编辑者/观察者角色 |
| W17-18 | 协作功能 | 数据共享视图、个人/共有资产标记、活动日志 |

---

### **阶段五：智能体验（4周，按需）**
**目标**：提升用户体验和智能化

| 周次 | 内容 | 交付物 |
|------|------|--------|
| W19-20 | 智能分析 | 资产健康度指标、配置建议、分类自定义、智能填充 |
| W21-22 | 极简录入 | 语音记账（Web Speech API）、OCR小票识别、批量导入 |

---

### **阶段六：PWA + 优化（3周，按需）**
**目标**：离线可用 + 性能优化

| 内容 | 说明 |
|------|------|
| PWA 支持 | Service Worker、离线缓存、添加到主屏 |
| 离线模式 | 离线记账队列、联网自动同步 |
| 性能优化 | 首屏加载优化、图表懒加载、虚拟滚动 |

---

### **时间线总览**

```
MVP        ████████████ 6周
数据增强   ██████ 4周
云端化     ██████ 4周
家庭协作   ██████ 4周
智能体验   ██████ 4周（按需）
PWA优化    █████ 3周（按需）
                        ────────────────
核心可用   14周（约3.5个月）
完整版     22周（约5.5个月）
全功能     25周（约6个月）
```

---

### **风险管理**

| 风险 | 缓解措施 |
|------|---------|
| 工期预估不准 | 每阶段预留20%缓冲，每2周复盘 |
| 需求变更 | 锁定MVP范围，变更放入后续迭代 |
| 技术难点 | 技术预研（W1），关键POC提前验证 |
| 人员变动 | 代码规范、文档完善、结对编程 |

---

### **技术栈调整**

| 模块 | 原方案 | 调整后 | 原因 |
|------|--------|--------|------|
| 图表库 | ECharts | Chart.js | MVP更轻量，后续可升级 |
| MVP存储 | PostgreSQL | IndexedDB | 无需后端，快速启动 |
| 同步方案 | WebSocket | 轮询/手动同步 | 降低复杂度，够用即可 |
| 组件库 | 二选一 | Naive UI | 更轻量，Vue 3原生支持 |

---

## 7. 验收标准

- ✅ 首次使用引导在3分钟内完成首笔资产录入
- ✅ 记账操作不超过3次点击
- ✅ 1000条流水查询响应<500ms
- ✅ 导出100条资产清单PDF<5秒
- ✅ 支持离线记账，联网后自动合并无冲突

---

**下一步**：您希望我细化哪个模块的交互原型或技术实现细节？